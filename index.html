<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>كشفُ الغِطاءِ عن محاسنِ الأخطاءِ</title>

<!-- IBM Plex Sans Arabic -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* Global font */
html, body, * { font-family: 'IBM Plex Sans Arabic', Arial, sans-serif !important; margin:0; padding:0; box-sizing:border-box; }

/* Variables */
:root {
  --bg-color: #fbfbfd;
  --text-main: #1d1d1f;
  --text-secondary: #6e6e73;
  --bubble-primary: #f0f0f5;
  --bubble-reply: #ffffff;
  --bubble-reply2: #f9f9fc;
  --shadow-soft: 0 12px 30px rgba(0,0,0,0.08);
  --shadow-hover: 0 20px 60px rgba(0,0,0,0.12);
  --transition: all 0.5s cubic-bezier(0.16,1,0.3,1);
}

/* Dark Mode */
:root.dark {
  --bg-color: #121212;
  --text-main: #eee;
  --text-secondary: #aaa;
  --bubble-primary: #1e1e1e;
  --bubble-reply: #222;
  --bubble-reply2: #2a2a2a;
  --shadow-soft: 0 12px 30px rgba(0,0,0,0.3);
  --shadow-hover: 0 20px 60px rgba(0,0,0,0.5);
}

/* Body */
body { background: var(--bg-color); color: var(--text-main); line-height:1.8; padding:80px 20px; display:flex; flex-direction:column; align-items:center; transition:0.4s; }

/* Toggle dark mode */
#dark-toggle { position:absolute; top:20px; left:20px; border:none; background:#000; color:#fff; padding:8px 14px; border-radius:12px; font-weight:600; cursor:pointer; opacity:0.85; transition:0.3s; }
#dark-toggle:hover { opacity:1; }

/* Header */
header { max-width:900px; text-align:center; margin-bottom:50px; }
header h1 { font-size:3rem; font-weight:700; margin-bottom:12px; }
header p { font-weight:300; font-size:1.3rem; color:var(--text-secondary); max-width:600px; margin:0 auto; }

/* Container */
.container { max-width:850px; width:100%; }

/* Messages */
.message-node { position:relative; margin-bottom:20px; }
.reply-level-1 { margin-right:35px; }
.reply-level-2 { margin-right:70px; }

/* Bubble */
.bubble { padding:22px 28px; border-radius:20px; box-shadow:var(--shadow-soft); cursor:pointer; transition:var(--transition); position:relative; word-break:break-word; font-weight:400; }
.message-node:first-child .bubble { background:var(--bubble-primary); }
.message-node.reply-level-1 .bubble { background:var(--bubble-reply); }
.message-node.reply-level-2 .bubble { background:var(--bubble-reply2); }
.bubble:hover { transform:scale(1.02); box-shadow:var(--shadow-hover); }

/* Labels & Text */
.label { display:block; font-size:0.85rem; font-weight:600; color:var(--text-secondary); margin-bottom:6px; }
.text-content { font-size:1.1rem; line-height:1.65; }
.commentary { transform:scaleY(0); transform-origin:top; opacity:0; transition:transform 0.5s,var(--transition); background:rgba(0,0,0,0.02); border-radius:0 0 20px 20px; padding:0 28px; margin-top:5px; position:relative; }
.message-node.active .commentary { transform:scaleY(1); opacity:1; padding:20px 28px 28px 28px; }

/* Advice text */
.advice-header { font-weight:500; font-size:0.98rem; margin-bottom:6px; color:var(--text-main); }
.advice-text { font-weight:300; font-size:1.1rem; line-height:1.7; color:var(--text-secondary); }

/* Sources */
.source-icon { position:absolute; bottom:8px; left:28px; font-size:0.9rem; cursor:pointer; color:var(--text-secondary); transition:color 0.3s; }
.source-icon:hover { color:#007aff; }
.sources-popup { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:var(--bg-color); color:var(--text-main); border-radius:24px; padding:30px 40px; box-shadow:0 20px 60px rgba(0,0,0,0.3); max-width:90%; max-height:80%; overflow-y:auto; z-index:1000; }
.sources-popup h3 { font-weight:600; margin-bottom:16px; }
.sources-popup a { display:block; margin-bottom:8px; color:#007aff; text-decoration:none; }
.sources-popup a:hover { text-decoration:underline; }
.sources-popup button { margin-top:15px; padding:6px 12px; border:none; border-radius:10px; cursor:pointer; background:#007aff; color:#fff; }

/* Arrow Icon */
.arrow-icon { position:absolute; left:28px; top:28px; width:20px; height:20px; fill:none; stroke:#d2d2d7; stroke-width:1.5; transition:transform 0.4s,stroke 0.3s; }
.message-node.active .arrow-icon { transform:rotate(180deg); stroke:var(--text-main); }

/* Connectors */
.connector { position:absolute; right:-18px; top:-22px; width:16px; height:35px; border-right:1px solid #e0e0e0; border-bottom:1px solid #e0e0e0; border-bottom-right-radius:10px; }

/* Final Panel */
.final-panel { margin-top:100px; padding:60px 36px; background:#000; color:#fff; border-radius:36px; text-align:center; box-shadow:0 30px 70px rgba(0,0,0,0.15); }
.final-panel h2 { font-weight:700; margin-bottom:18px; font-size:2.2rem; }
.final-panel p { color:#86868b; font-weight:300; font-size:1.15rem; line-height:1.6; max-width:550px; margin:0 auto; }

/* FAQ Cards */
.faq-node { margin-top:30px; border-radius:20px; box-shadow:var(--shadow-soft); overflow:hidden; transition:var(--transition); background:var(--bubble-primary); cursor:pointer; }
.faq-header { padding:18px 24px; font-weight:500; font-size:1.05rem; position:relative; }
.faq-header svg { position:absolute; left:20px; top:18px; width:18px; height:18px; stroke:#d2d2d7; stroke-width:1.5; transition:transform 0.3s; }
.faq-node.active .faq-header svg { transform:rotate(180deg); }
.faq-content { max-height:0; opacity:0; padding:0 24px; font-size:1.05rem; font-weight:300; line-height:1.7; color:var(--text-secondary); transition:0.4s; }
.faq-node.active .faq-content { max-height:400px; opacity:1; padding:18px 24px; }

/* Animations */
@keyframes fadeIn{ from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

</style>
</head>
<body>

<!-- Dark Mode Toggle -->
<button id="dark-toggle">تبديل الوضع الليلي</button>

<header>
  <h1>كشفُ الغِطاءِ عن محاسنِ الأخطاءِ</h1>
  <p>نظرة متأملة في أسلوب النقاش لتعزيز الحكمة في الرد</p>
</header>

<div class="container">

  <!-- Example comment + reply -->
  <div class="message-node" onclick="toggleNode(this)">
    <div class="bubble">
      <svg class="arrow-icon" viewBox="0 0 24 24"><path d="M6 9l6 6 6-6"/></svg>
      <span class="label">الطرف الأول</span>
      <p class="text-content">"هنا يوضع النص الأصلي للتعليق الأول بكل تفاصيله."</p>
    </div>
    <div class="commentary" data-sources="https://quran.com/2/2,https://quran.com/3/7">
      <span class="advice-header">تحليل الطرح من وجهة نظر موضوعية:</span>
      <p class="advice-text">مثال على تحليل موضوعي بالاعتماد على القرآن.</p>
      <span class="source-icon" onclick="showSources(this)">المصادر</span>
    </div>
  </div>

  <div class="message-node reply-level-1" onclick="toggleNode(this)">
    <div class="connector"></div>
    <div class="bubble">
      <svg class="arrow-icon" viewBox="0 0 24 24"><path d="M6 9l6 6 6-6"/></svg>
      <span class="label">الطرف الثاني</span>
      <p class="text-content">"الرد المفصل من الطرف الثاني مع التعليق على النقاط."</p>
    </div>
    <div class="commentary" data-sources="">
      <span class="advice-header">لماذا لم يكن الرد مثالياً؟</span>
      <p class="advice-text">شرح مستند للقرآن يوضح مواضع التحسين.</p>
      <span class="source-icon" onclick="showSources(this)">المصادر</span>
    </div>
  </div>

  <!-- FAQ Example -->
  <div class="faq-node" onclick="toggleFAQ(this)">
    <div class="faq-header">
      كيف أعلم أن الرد كان صحيحاً؟
      <svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none"/></svg>
    </div>
    <div class="faq-content">
      <p>بالاعتماد على القرآن، إذا كان الرد لا يخالف ما جاء فيه وكان هادفاً في التوجيه، فهو صحيح.</p>
    </div>
  </div>

  <div class="final-panel">
    <h2>خلاصة المراجعة</h2>
    <p>إن الهدف من مراجعة هذا الحوار هو الارتقاء بالكلمة، فالمسلم كالغيث حيثما وقع نفع، والكلمة الطيبة صدقة.</p>
  </div>

</div>

<footer>تصميم مخصص لغرض المراجعة الفكرية &copy; 2026</footer>

<!-- Sources popup -->
<div id="sources-popup" class="sources-popup">
  <h3>المصادر</h3>
  <div id="sources-list"></div>
  <button onclick="closeSources()">إغلاق</button>
</div>

<script>
/* Toggle comment/reply expansion */
function toggleNode(el){
  document.querySelectorAll('.message-node').forEach(node=>{ if(node!==el) node.classList.remove('active'); });
  el.classList.toggle('active');
}

/* Toggle FAQ */
function toggleFAQ(el){
  el.classList.toggle('active');
}

/* Dark Mode */
const darkToggle=document.getElementById('dark-toggle');
darkToggle.addEventListener('click',()=>{
  document.documentElement.classList.toggle('dark');
  if(document.documentElement.classList.contains('dark')) localStorage.setItem('darkmode','true');
  else localStorage.removeItem('darkmode');
});
if(localStorage.getItem('darkmode')==='true'){ document.documentElement.classList.add('dark'); }

/* Sources popup */
function showSources(el){
  const popup=document.getElementById('sources-popup');
  const list=document.getElementById('sources-list');
  list.innerHTML='';
  const data=el.parentElement.getAttribute('data-sources');
  if(data){
    const urls=data.split(',');
    urls.forEach(url=>{
      const a=document.createElement('a');
      a.href=url.trim(); a.target='_blank'; a.textContent=url.trim();
      list.appendChild(a);
    });
  } else {
    const p=document.createElement('p');
    p.textContent='لا توجد مصادر حالياً';
    list.appendChild(p);
  }
  popup.style.display='block';
}
function closeSources(){ document.getElementById('sources-popup').style.display='none'; }
</script>
</body>
</html>
